<template>
  <div if.bind="uploadingFiles === undefined">
    <div class="file" >
      <label class="file-label">
        <input change.trigger="upload(selectedFiles)" files.bind="selectedFiles" class="file-input" type="file" name="resume">
        <span class="file-cta">
          <span class="file-label">
            Choose a file to transferâ€¦
          </span>
        </span>
      </label>
    </div>
    <div>
    or
    </div>
    <div class="field has-addons">
      <div class="control">
        <input class="input" type="text" placeholder="Type your code to receive a file" value.bind="code"/>
      </div>
      <div class="control">
        <a class="button is-info" click.trigger="redirectToDownload()">
          Receive
        </a>
      </div>
    </div>
  </div>
  <div if.bind="uploadingFiles !== undefined">
    <div if.bind="torrent === undefined">
      <compose view="./spinner.html"></compose>
    </div>
    <div if.bind="torrent !== undefined">
      <h2 class="has-text-centered">Uploading</h2>
      <div class="level">
        <div class="level-item has-text-centered">
          <div>
            <h4 class="heading">Peers</h4>
            <p class="title">${torrent.numPeers}</p>
          </div>
        </div>
        <div class="level-item has-text-centered">
          <div>
            <h4 class="heading">Upload</h4>
            <p class="title">${prettyBytes(torrent.uploadSpeed)}/s</p>
          </div>
        </div>
        <div class="level-item has-text-centered">
          <div>
            <h4 class="heading">Size</h4>
            <p class="title">${prettyBytes(torrent.length)}</p>
          </div>
        </div>
      </div>
      <div class="is-size-3 has-text-centered"> ${code}</div>
      Enter your code on a new page or go to the following address to download the file.<br/>
      The link and code will stay valid as long as this page is open.<br/>
      <div class="has-text-centered">
        <a class="is-size-4" href.bind="buildLinkHref(code)">${buildLinkHref()}</a><br/>
        <compose view-model="qr" model.bind="{ qrText: buildLinkHref() }"></compose>
      </div>
    </div>
  </div>
</template>
